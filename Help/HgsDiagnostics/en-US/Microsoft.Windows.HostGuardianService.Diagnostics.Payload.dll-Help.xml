<?xml version="1.0" encoding="utf-8"?>
<helpItems xmlns:maml="http://schemas.microsoft.com/maml/2004/10" xmlns:command="http://schemas.microsoft.com/maml/dev/command/2004/10" xmlns:dev="http://schemas.microsoft.com/maml/dev/2004/10" schema="maml" xmlns="http://msh">
  <command:command>
    <command:details>
      <command:name>Get-HgsTrace</command:name>
      <maml:description>
        <maml:para>Collects and analyzes data relevant to the operation of a guarded fabric.</maml:para>
      </maml:description>
      <command:verb>Get</command:verb>
      <command:noun>HgsTrace</command:noun>
    </command:details>
    <maml:description>
      <maml:para>The **Get-HgsTrace** cmdlet collects and analyzes data relevant to the operation of a guarded fabric, diagnosing confirmed and potential failures in the environment that will impact the operation of the Host Guardian Service (HGS), guarded hosts, and shielded virtual machines.</maml:para>
    </maml:description>
    <command:syntax>
      <command:syntaxItem>
        <maml:name>Get-HgsTrace</maml:name>
        <command:parameter required="false" variableLength="false" globbing="false" pipelineInput="false" position="Named" aliases="none">
          <maml:name>Collector</maml:name>
          <maml:description>
            <maml:para>Specifies a list of collectors to be executed when gathering traces.
This parameter is used to collect only specific traces when you do not specify a list of diagnostics and you do not run diagnostics with the *RunDiagnostics* switch.</maml:para>
          </maml:description>
          <command:parameterValue required="false" variableLength="true">String[]</command:parameterValue>
        </command:parameter>
        <command:parameter required="false" variableLength="false" globbing="false" pipelineInput="false" position="Named" aliases="none">
          <maml:name>Compact</maml:name>
          <maml:description>
            <maml:para>Indicates that the output object is provided should be a minimal subset of the results generated instead of the complete result set.
This switch parameter is ignored if more than one target is provided.</maml:para>
          </maml:description>
          <command:parameterValue required="false" variableLength="true">SwitchParameter</command:parameterValue>
        </command:parameter>
        <command:parameter required="false" variableLength="false" globbing="false" pipelineInput="false" position="Named" aliases="none">
          <maml:name>Detailed</maml:name>
          <maml:description>
            <maml:para>Specifies that the output object has full details, which includes all results omitted from the default output report.</maml:para>
          </maml:description>
          <command:parameterValue required="false" variableLength="true">SwitchParameter</command:parameterValue>
        </command:parameter>
        <command:parameter required="false" variableLength="false" globbing="false" pipelineInput="false" position="Named" aliases="none">
          <maml:name>Diagnostic</maml:name>
          <maml:description>
            <maml:para>Specifies a list of diagnostics that are run if you also provide the *RunDiagnostics* switch parameter.
If you do not provide the *RunDiagnostics* switch parameter, this list of diagnostics is used to determine which collectors are executed.
Diagnostics and collectors whose requirements are not satisfied by the provided targets will not be executed.</maml:para>
          </maml:description>
          <command:parameterValue required="false" variableLength="true">String[]</command:parameterValue>
        </command:parameter>
        <command:parameter required="false" variableLength="false" globbing="false" pipelineInput="false" position="0" aliases="none">
          <maml:name>Path</maml:name>
          <maml:description>
            <maml:para>Specifies an absolute or relative path to a folder where trace files are stored.
If the folder already exists, any traces contained therein are reused.
New traces are collected to augment existing traces if they are missing from the pre-populated traces.</maml:para>
          </maml:description>
          <command:parameterValue required="false" variableLength="true">String</command:parameterValue>
        </command:parameter>
        <command:parameter required="false" variableLength="false" globbing="false" pipelineInput="false" position="Named" aliases="none">
          <maml:name>Target</maml:name>
          <maml:description>
            <maml:para>Specifies a list of targets created by **New-HgsTraceTarget** to be traced and diagnosed.
If no targets are provided, but a collection path has been specified, the path is searched for pre-existing traces to be analyzed.
If none are found, the localhost is targeted using the current session's credentials inferring the host's role from installed Windows features.</maml:para>
          </maml:description>
          <command:parameterValue required="false" variableLength="true">InputTarget[]</command:parameterValue>
        </command:parameter>
        <command:parameter required="false" variableLength="false" globbing="false" pipelineInput="false" position="Named" aliases="none">
          <maml:name>WriteManifest</maml:name>
          <maml:description>
            <maml:para>Indicates that a manifest of all trace files collected are written.
This can then be used by the **Get-HgsTraceFileData** cmdlet to get secured information about trace files.</maml:para>
          </maml:description>
          <command:parameterValue required="false" variableLength="true">SwitchParameter</command:parameterValue>
        </command:parameter>
      </command:syntaxItem>
      <command:syntaxItem>
        <maml:name>Get-HgsTrace</maml:name>
        <command:parameter required="false" variableLength="false" globbing="false" pipelineInput="false" position="Named" aliases="none">
          <maml:name>Compact</maml:name>
          <maml:description>
            <maml:para>Indicates that the output object is provided should be a minimal subset of the results generated instead of the complete result set.
This switch parameter is ignored if more than one target is provided.</maml:para>
          </maml:description>
          <command:parameterValue required="false" variableLength="true">SwitchParameter</command:parameterValue>
        </command:parameter>
        <command:parameter required="false" variableLength="false" globbing="false" pipelineInput="false" position="Named" aliases="none">
          <maml:name>Detailed</maml:name>
          <maml:description>
            <maml:para>Specifies that the output object has full details, which includes all results omitted from the default output report.</maml:para>
          </maml:description>
          <command:parameterValue required="false" variableLength="true">SwitchParameter</command:parameterValue>
        </command:parameter>
        <command:parameter required="false" variableLength="false" globbing="false" pipelineInput="false" position="Named" aliases="none">
          <maml:name>Diagnostic</maml:name>
          <maml:description>
            <maml:para>Specifies a list of diagnostics that are run if you also provide the *RunDiagnostics* switch parameter.
If you do not provide the *RunDiagnostics* switch parameter, this list of diagnostics is used to determine which collectors are executed.
Diagnostics and collectors whose requirements are not satisfied by the provided targets will not be executed.</maml:para>
          </maml:description>
          <command:parameterValue required="false" variableLength="true">String[]</command:parameterValue>
        </command:parameter>
        <command:parameter required="false" variableLength="false" globbing="false" pipelineInput="false" position="0" aliases="none">
          <maml:name>Path</maml:name>
          <maml:description>
            <maml:para>Specifies an absolute or relative path to a folder where trace files are stored.
If the folder already exists, any traces contained therein are reused.
New traces are collected to augment existing traces if they are missing from the pre-populated traces.</maml:para>
          </maml:description>
          <command:parameterValue required="false" variableLength="true">String</command:parameterValue>
        </command:parameter>
        <command:parameter required="true" variableLength="false" globbing="false" pipelineInput="false" position="Named" aliases="none">
          <maml:name>RunDiagnostics</maml:name>
          <maml:description>
            <maml:para>Indicates that diagnostics are immediately run against the collected traces and that the result set describes the result of diagnosing the collected information.</maml:para>
          </maml:description>
          <command:parameterValue required="true" variableLength="true">SwitchParameter</command:parameterValue>
        </command:parameter>
        <command:parameter required="false" variableLength="false" globbing="false" pipelineInput="false" position="Named" aliases="none">
          <maml:name>Target</maml:name>
          <maml:description>
            <maml:para>Specifies a list of targets created by **New-HgsTraceTarget** to be traced and diagnosed.
If no targets are provided, but a collection path has been specified, the path is searched for pre-existing traces to be analyzed.
If none are found, the localhost is targeted using the current session's credentials inferring the host's role from installed Windows features.</maml:para>
          </maml:description>
          <command:parameterValue required="false" variableLength="true">InputTarget[]</command:parameterValue>
        </command:parameter>
        <command:parameter required="false" variableLength="false" globbing="false" pipelineInput="false" position="Named" aliases="none">
          <maml:name>WriteManifest</maml:name>
          <maml:description>
            <maml:para>Indicates that a manifest of all trace files collected are written.
This can then be used by the **Get-HgsTraceFileData** cmdlet to get secured information about trace files.</maml:para>
          </maml:description>
          <command:parameterValue required="false" variableLength="true">SwitchParameter</command:parameterValue>
        </command:parameter>
      </command:syntaxItem>
    </command:syntax>
    <command:parameters>
      <command:parameter required="false" variableLength="false" globbing="false" pipelineInput="false" position="Named" aliases="none">
        <maml:name>Collector</maml:name>
        <maml:description>
          <maml:para>Specifies a list of collectors to be executed when gathering traces.
This parameter is used to collect only specific traces when you do not specify a list of diagnostics and you do not run diagnostics with the *RunDiagnostics* switch.</maml:para>
        </maml:description>
        <command:parameterValue required="false" variableLength="true">String[]</command:parameterValue>
      </command:parameter>
      <command:parameter required="false" variableLength="false" globbing="false" pipelineInput="false" position="Named" aliases="none">
        <maml:name>Compact</maml:name>
        <maml:description>
          <maml:para>Indicates that the output object is provided should be a minimal subset of the results generated instead of the complete result set.
This switch parameter is ignored if more than one target is provided.</maml:para>
        </maml:description>
        <command:parameterValue required="false" variableLength="true">SwitchParameter</command:parameterValue>
      </command:parameter>
      <command:parameter required="false" variableLength="false" globbing="false" pipelineInput="false" position="Named" aliases="none">
        <maml:name>Detailed</maml:name>
        <maml:description>
          <maml:para>Specifies that the output object has full details, which includes all results omitted from the default output report.</maml:para>
        </maml:description>
        <command:parameterValue required="false" variableLength="true">SwitchParameter</command:parameterValue>
      </command:parameter>
      <command:parameter required="false" variableLength="false" globbing="false" pipelineInput="false" position="Named" aliases="none">
        <maml:name>Diagnostic</maml:name>
        <maml:description>
          <maml:para>Specifies a list of diagnostics that are run if you also provide the *RunDiagnostics* switch parameter.
If you do not provide the *RunDiagnostics* switch parameter, this list of diagnostics is used to determine which collectors are executed.
Diagnostics and collectors whose requirements are not satisfied by the provided targets will not be executed.</maml:para>
        </maml:description>
        <command:parameterValue required="false" variableLength="true">String[]</command:parameterValue>
      </command:parameter>
      <command:parameter required="false" variableLength="false" globbing="false" pipelineInput="false" position="0" aliases="none">
        <maml:name>Path</maml:name>
        <maml:description>
          <maml:para>Specifies an absolute or relative path to a folder where trace files are stored.
If the folder already exists, any traces contained therein are reused.
New traces are collected to augment existing traces if they are missing from the pre-populated traces.</maml:para>
        </maml:description>
        <command:parameterValue required="false" variableLength="true">String</command:parameterValue>
      </command:parameter>
      <command:parameter required="true" variableLength="false" globbing="false" pipelineInput="false" position="Named" aliases="none">
        <maml:name>RunDiagnostics</maml:name>
        <maml:description>
          <maml:para>Indicates that diagnostics are immediately run against the collected traces and that the result set describes the result of diagnosing the collected information.</maml:para>
        </maml:description>
        <command:parameterValue required="true" variableLength="true">SwitchParameter</command:parameterValue>
      </command:parameter>
      <command:parameter required="false" variableLength="false" globbing="false" pipelineInput="false" position="Named" aliases="none">
        <maml:name>Target</maml:name>
        <maml:description>
          <maml:para>Specifies a list of targets created by **New-HgsTraceTarget** to be traced and diagnosed.
If no targets are provided, but a collection path has been specified, the path is searched for pre-existing traces to be analyzed.
If none are found, the localhost is targeted using the current session's credentials inferring the host's role from installed Windows features.</maml:para>
        </maml:description>
        <command:parameterValue required="false" variableLength="true">InputTarget[]</command:parameterValue>
      </command:parameter>
      <command:parameter required="false" variableLength="false" globbing="false" pipelineInput="false" position="Named" aliases="none">
        <maml:name>WriteManifest</maml:name>
        <maml:description>
          <maml:para>Indicates that a manifest of all trace files collected are written.
This can then be used by the **Get-HgsTraceFileData** cmdlet to get secured information about trace files.</maml:para>
        </maml:description>
        <command:parameterValue required="false" variableLength="true">SwitchParameter</command:parameterValue>
      </command:parameter>
    </command:parameters>
    <command:inputTypes>
      <command:inputType>
        <dev:type>
          <dev:name>Microsoft.Windows.HostGuardianService.Diagnostics.Payload.InputTarget</dev:name>
        </dev:type>
        <maml:description>
          <maml:para>This cmdlet pipes one or more targets created with **New-HgsTraceTarget** to trace and diagnose.</maml:para>
        </maml:description>
      </command:inputType>
    </command:inputTypes>
    <command:returnValues>
      <command:returnValue>
        <dev:type>
          <dev:name>Microsoft.Windows.HostGuardianService.Diagnostics.Payload.RemoteResultSet</dev:name>
        </dev:type>
        <maml:description>
          <maml:para>This cmdlet returns a collection of results for various operations and tests performed on the provided targets.
These results are grouped by target and category with each group possessing an aggregate result that reflects the status of all child operation.</maml:para>
        </maml:description>
      </command:returnValue>
    </command:returnValues>
    <maml:alertSet>
      <maml:alert>
        <maml:para />
      </maml:alert>
    </maml:alertSet>
    <command:examples>
      <command:example>
        <maml:title>--------- Example 1: Diagnose the local host ---------</maml:title>
        <maml:introduction>
          <maml:para>```
PS C:\&gt; Get-HgsTrace -RunDiagnostics
```</maml:para>
          <maml:para>&#x80;</maml:para>
          <maml:para>This command diagnoses the local host.
The traces are stored in a temporary folder and diagnosis results are reported to the user.</maml:para>
        </maml:introduction>
        <dev:code />
        <dev:remarks />
      </command:example>
      <command:example>
        <maml:title>--------- Example 2: Collect traces from the specified target ---------</maml:title>
        <maml:introduction>
          <maml:para>```
PS C:\&gt; Get-HgsTrace -Target $VMhost -Path ".\Traces"
```</maml:para>
          <maml:para>&#x80;</maml:para>
          <maml:para>This command collects traces from the target specified in the VMhost variable.
The command then stores the trace files to the specified path.
Since the *RunDiagnostics* parameter is not used, the cmdlet does not run diagnostics against the collected targets.</maml:para>
        </maml:introduction>
        <dev:code />
        <dev:remarks />
      </command:example>
      <command:example>
        <maml:title>--------- Example 3: Diagnose multiple targets ---------</maml:title>
        <maml:introduction>
          <maml:para>```
PS C:\&gt; Get-HgsTrace -Target $VMhost,$Server -RunDiagnostics
```</maml:para>
          <maml:para>&#x80;</maml:para>
          <maml:para>This command runs diagnostics on the targets stored in the $VMHost and $Server variables.</maml:para>
        </maml:introduction>
        <dev:code />
        <dev:remarks />
      </command:example>
      <command:example>
        <maml:title>--------- Example 4: Diagnose the local host using hardware ---------</maml:title>
        <maml:introduction>
          <maml:para>```
PS C:\&gt; Get-HgsTrace -RunDiagnostics -Diagnostic "Hardware"
```</maml:para>
          <maml:para>&#x80;</maml:para>
          <maml:para>This command runs diagnostics named Hardware on the local host.</maml:para>
        </maml:introduction>
        <dev:code />
        <dev:remarks />
      </command:example>
      <command:example>
        <maml:title>--------- Example 5: Diagnose previously collected traces stored in the specified folder ---------</maml:title>
        <maml:introduction>
          <maml:para>```
PS C:\&gt; Get-HgsTrace -RunDiagnostics -Path ".\GatheredTraces"
```</maml:para>
          <maml:para>&#x80;</maml:para>
          <maml:para>This command runs diagnostics on collected traces that are stored in the folder named GatheredTraces.</maml:para>
        </maml:introduction>
        <dev:code />
        <dev:remarks />
      </command:example>
    </command:examples>
    <command:relatedLinks>
      <maml:navigationLink>
        <maml:linkText>Online Version</maml:linkText>
        <command:uri>https://learn.microsoft.com/powershell/module/hgsdiagnostics/get-hgstrace?view=windowsserver2025-ps&amp;wt.mc_id=ps-gethelp</command:uri>
      </maml:navigationLink>
      <maml:navigationLink>
        <maml:linkText>Get-HgsTraceFileData</maml:linkText>
        <command:uri>./Get-HgsTraceFileData.md</command:uri>
      </maml:navigationLink>
      <maml:navigationLink>
        <maml:linkText>New-HgsTraceTarget</maml:linkText>
        <command:uri>./New-HgsTraceTarget.md</command:uri>
      </maml:navigationLink>
    </command:relatedLinks>
  </command:command>
  <command:command>
    <command:details>
      <command:name>Get-HgsTraceFileData</command:name>
      <maml:description>
        <maml:para>Gets metadata about and the contents of HGS Diagnostic trace files recorded in a trace manifest.</maml:para>
      </maml:description>
      <command:verb>Get</command:verb>
      <command:noun>HgsTraceFileData</command:noun>
    </command:details>
    <maml:description>
      <maml:para>The **Get-HgsTraceFileData** cmdlet gets segments of Host Guardian Service (HGS) Diagnostic trace files recorded in a trace file manifest generated by **Get-HgsTrace**, as well as length information. This cmdlet is utilized by the **Get-HgsTrace** cmdlet to securely get trace files over a Windows PowerShell® remote session that does not expose other portions of the file system.</maml:para>
    </maml:description>
    <command:syntax>
      <command:syntaxItem>
        <maml:name>Get-HgsTraceFileData</maml:name>
        <command:parameter required="true" variableLength="false" globbing="false" pipelineInput="false" position="Named" aliases="none">
          <maml:name>File</maml:name>
          <maml:description>
            <maml:para>Specifies the full path of the file that you wish to query.
The file must be in the manifest specified in the *Manifest* parameter.</maml:para>
          </maml:description>
          <command:parameterValue required="true" variableLength="true">String</command:parameterValue>
        </command:parameter>
        <command:parameter required="true" variableLength="false" globbing="false" pipelineInput="false" position="Named" aliases="none">
          <maml:name>Manifest</maml:name>
          <maml:description>
            <maml:para>Specifies the path to the manifest file that documents the trace file specified in the *File* parameter.</maml:para>
          </maml:description>
          <command:parameterValue required="true" variableLength="true">String</command:parameterValue>
        </command:parameter>
        <command:parameter required="true" variableLength="false" globbing="false" pipelineInput="false" position="Named" aliases="none">
          <maml:name>StartByte</maml:name>
          <maml:description>
            <maml:para>Specifies the starting byte from which this cmdlet gets a segment of the trace file's data.
This value must be greater than 0 but less than the total length of the requested file.</maml:para>
          </maml:description>
          <command:parameterValue required="true" variableLength="true">Int64</command:parameterValue>
        </command:parameter>
      </command:syntaxItem>
      <command:syntaxItem>
        <maml:name>Get-HgsTraceFileData</maml:name>
        <command:parameter required="true" variableLength="false" globbing="false" pipelineInput="false" position="Named" aliases="none">
          <maml:name>File</maml:name>
          <maml:description>
            <maml:para>Specifies the full path of the file that you wish to query.
The file must be in the manifest specified in the *Manifest* parameter.</maml:para>
          </maml:description>
          <command:parameterValue required="true" variableLength="true">String</command:parameterValue>
        </command:parameter>
        <command:parameter required="true" variableLength="false" globbing="false" pipelineInput="false" position="Named" aliases="none">
          <maml:name>Length</maml:name>
          <maml:description>
            <maml:para>Indicates that this cmdlet gets the total length, in bytes, of the trace file, instead of a data segment.</maml:para>
          </maml:description>
          <command:parameterValue required="true" variableLength="true">SwitchParameter</command:parameterValue>
        </command:parameter>
        <command:parameter required="true" variableLength="false" globbing="false" pipelineInput="false" position="Named" aliases="none">
          <maml:name>Manifest</maml:name>
          <maml:description>
            <maml:para>Specifies the path to the manifest file that documents the trace file specified in the *File* parameter.</maml:para>
          </maml:description>
          <command:parameterValue required="true" variableLength="true">String</command:parameterValue>
        </command:parameter>
      </command:syntaxItem>
    </command:syntax>
    <command:parameters>
      <command:parameter required="true" variableLength="false" globbing="false" pipelineInput="false" position="Named" aliases="none">
        <maml:name>File</maml:name>
        <maml:description>
          <maml:para>Specifies the full path of the file that you wish to query.
The file must be in the manifest specified in the *Manifest* parameter.</maml:para>
        </maml:description>
        <command:parameterValue required="true" variableLength="true">String</command:parameterValue>
      </command:parameter>
      <command:parameter required="true" variableLength="false" globbing="false" pipelineInput="false" position="Named" aliases="none">
        <maml:name>Length</maml:name>
        <maml:description>
          <maml:para>Indicates that this cmdlet gets the total length, in bytes, of the trace file, instead of a data segment.</maml:para>
        </maml:description>
        <command:parameterValue required="true" variableLength="true">SwitchParameter</command:parameterValue>
      </command:parameter>
      <command:parameter required="true" variableLength="false" globbing="false" pipelineInput="false" position="Named" aliases="none">
        <maml:name>Manifest</maml:name>
        <maml:description>
          <maml:para>Specifies the path to the manifest file that documents the trace file specified in the *File* parameter.</maml:para>
        </maml:description>
        <command:parameterValue required="true" variableLength="true">String</command:parameterValue>
      </command:parameter>
      <command:parameter required="true" variableLength="false" globbing="false" pipelineInput="false" position="Named" aliases="none">
        <maml:name>StartByte</maml:name>
        <maml:description>
          <maml:para>Specifies the starting byte from which this cmdlet gets a segment of the trace file's data.
This value must be greater than 0 but less than the total length of the requested file.</maml:para>
        </maml:description>
        <command:parameterValue required="true" variableLength="true">Int64</command:parameterValue>
      </command:parameter>
    </command:parameters>
    <command:inputTypes />
    <command:returnValues>
      <command:returnValue>
        <dev:type>
          <dev:name>System.Int64</dev:name>
        </dev:type>
        <maml:description>
          <maml:para />
        </maml:description>
      </command:returnValue>
      <command:returnValue>
        <dev:type>
          <dev:name>System.Byte</dev:name>
        </dev:type>
        <maml:description>
          <maml:para />
        </maml:description>
      </command:returnValue>
    </command:returnValues>
    <maml:alertSet>
      <maml:alert>
        <maml:para />
      </maml:alert>
    </maml:alertSet>
    <command:examples>
      <command:example>
        <maml:title>--------- Example 1: Get the length of a trace file ---------</maml:title>
        <maml:introduction>
          <maml:para>```
PS C:\&gt; Get-TraceFileData -File "Certificates.xml" -Manifest "Traces.xml" -Length
```</maml:para>
          <maml:para>&#x80;</maml:para>
          <maml:para>This command gets the length of the file named Certificates.xml file found in the Traces.xml manifest.</maml:para>
        </maml:introduction>
        <dev:code />
        <dev:remarks />
      </command:example>
      <command:example>
        <maml:title>--------- Example 2: Get a segment of a trace file contained in a manifest ---------</maml:title>
        <maml:introduction>
          <maml:para>```
PS C:\&gt; Get-TraceFileData -File "Logs.evtx" -Manifest "Traces.xml" -StartByte 1024
```</maml:para>
          <maml:para>&#x80;</maml:para>
          <maml:para>This command gets a segment, in bytes, from the file named Logs.evtx if it is found in the Traces.xml manifest.
If the file is not found in the manifest, this cmdlet returns an error.</maml:para>
        </maml:introduction>
        <dev:code />
        <dev:remarks />
      </command:example>
    </command:examples>
    <command:relatedLinks>
      <maml:navigationLink>
        <maml:linkText>Online Version</maml:linkText>
        <command:uri>https://learn.microsoft.com/powershell/module/hgsdiagnostics/get-hgstracefiledata?view=windowsserver2025-ps&amp;wt.mc_id=ps-gethelp</command:uri>
      </maml:navigationLink>
      <maml:navigationLink>
        <maml:linkText>Get-HgsTrace</maml:linkText>
        <command:uri>./Get-HgsTrace.md</command:uri>
      </maml:navigationLink>
    </command:relatedLinks>
  </command:command>
  <command:command>
    <command:details>
      <command:name>New-HgsTraceTarget</command:name>
      <maml:description>
        <maml:para>Creates a HGS Diagnostics target object.</maml:para>
      </maml:description>
      <command:verb>New</command:verb>
      <command:noun>HgsTraceTarget</command:noun>
    </command:details>
    <maml:description>
      <maml:para>The **New-HgsTraceTarget** cmdlet creates a Host Guardian Service (HGS) Diagnostics target object. The **Get-HgsTrace** cmdlet can use this information to determine how to connect to a particular host as well as what aspects of the host to trace and diagnose.</maml:para>
    </maml:description>
    <command:syntax>
      <command:syntaxItem>
        <maml:name>New-HgsTraceTarget</maml:name>
        <command:parameter required="false" variableLength="false" globbing="false" pipelineInput="false" position="Named" aliases="none">
          <maml:name>Credential</maml:name>
          <maml:description>
            <maml:para>Specifies a **PSCredential** object under which the management group connection runs.
To obtain a **PSCredential** object, use the **Get-Credential** cmdlet.
For more information, type `Get-Help Get-Credential`.</maml:para>
          </maml:description>
          <command:parameterValue required="false" variableLength="true">PSCredential</command:parameterValue>
        </command:parameter>
        <command:parameter required="true" variableLength="false" globbing="false" pipelineInput="false" position="Named" aliases="none">
          <maml:name>HostName</maml:name>
          <maml:description>
            <maml:para>Specifies the hostname of the target.
This parameter is used to resolve an IP address when a remote Windows PowerShell® session is opened.</maml:para>
          </maml:description>
          <command:parameterValue required="true" variableLength="true">String</command:parameterValue>
        </command:parameter>
        <command:parameter required="false" variableLength="false" globbing="false" pipelineInput="false" position="Named" aliases="none">
          <maml:name>PSSessionConfigurationName</maml:name>
          <maml:description>
            <maml:para>Specifies the remote Windows PowerShell session configuration to utilize when a remote runspace is opened.
If you omit this parameter, the default runspace is utilized by the **Get-HgsTrace** cmdlet, or the HGS configuration for targets that have the HostGuardianService role.</maml:para>
          </maml:description>
          <command:parameterValue required="false" variableLength="true">String</command:parameterValue>
        </command:parameter>
        <command:parameter required="false" variableLength="false" globbing="false" pipelineInput="false" position="Named" aliases="none">
          <maml:name>Role</maml:name>
          <maml:description>
            <maml:para>Specifies the role a particular target plays in a guarded fabric.
This can be a HGS node (HostGuardianService) or a Guarded Host (GuardedHost).
If you do not specify a role, it will be inferred by the open connection and the inspection of the installed Windows features.</maml:para>
          </maml:description>
          <command:parameterValue required="false" variableLength="true">BaseHgsRoles[]</command:parameterValue>
        </command:parameter>
      </command:syntaxItem>
      <command:syntaxItem>
        <maml:name>New-HgsTraceTarget</maml:name>
        <command:parameter required="true" variableLength="false" globbing="false" pipelineInput="false" position="Named" aliases="none">
          <maml:name>HostName</maml:name>
          <maml:description>
            <maml:para>Specifies the hostname of the target.
This parameter is used to resolve an IP address when a remote Windows PowerShell® session is opened.</maml:para>
          </maml:description>
          <command:parameterValue required="true" variableLength="true">String</command:parameterValue>
        </command:parameter>
        <command:parameter required="true" variableLength="false" globbing="false" pipelineInput="false" position="Named" aliases="none">
          <maml:name>NoAccess</maml:name>
          <maml:description>
            <maml:para>Indicates that no access is available to the target.
Therefore, connections will never be opened to this target.</maml:para>
          </maml:description>
          <command:parameterValue required="true" variableLength="true">SwitchParameter</command:parameterValue>
        </command:parameter>
      </command:syntaxItem>
      <command:syntaxItem>
        <maml:name>New-HgsTraceTarget</maml:name>
        <command:parameter required="true" variableLength="false" globbing="false" pipelineInput="false" position="Named" aliases="none">
          <maml:name>Local</maml:name>
          <maml:description>
            <maml:para>Indicates that the created target is the current local host.</maml:para>
          </maml:description>
          <command:parameterValue required="true" variableLength="true">SwitchParameter</command:parameterValue>
        </command:parameter>
        <command:parameter required="false" variableLength="false" globbing="false" pipelineInput="false" position="Named" aliases="none">
          <maml:name>Role</maml:name>
          <maml:description>
            <maml:para>Specifies the role a particular target plays in a guarded fabric.
This can be a HGS node (HostGuardianService) or a Guarded Host (GuardedHost).
If you do not specify a role, it will be inferred by the open connection and the inspection of the installed Windows features.</maml:para>
          </maml:description>
          <command:parameterValue required="false" variableLength="true">BaseHgsRoles[]</command:parameterValue>
        </command:parameter>
      </command:syntaxItem>
    </command:syntax>
    <command:parameters>
      <command:parameter required="false" variableLength="false" globbing="false" pipelineInput="false" position="Named" aliases="none">
        <maml:name>Credential</maml:name>
        <maml:description>
          <maml:para>Specifies a **PSCredential** object under which the management group connection runs.
To obtain a **PSCredential** object, use the **Get-Credential** cmdlet.
For more information, type `Get-Help Get-Credential`.</maml:para>
        </maml:description>
        <command:parameterValue required="false" variableLength="true">PSCredential</command:parameterValue>
      </command:parameter>
      <command:parameter required="true" variableLength="false" globbing="false" pipelineInput="false" position="Named" aliases="none">
        <maml:name>HostName</maml:name>
        <maml:description>
          <maml:para>Specifies the hostname of the target.
This parameter is used to resolve an IP address when a remote Windows PowerShell® session is opened.</maml:para>
        </maml:description>
        <command:parameterValue required="true" variableLength="true">String</command:parameterValue>
      </command:parameter>
      <command:parameter required="true" variableLength="false" globbing="false" pipelineInput="false" position="Named" aliases="none">
        <maml:name>Local</maml:name>
        <maml:description>
          <maml:para>Indicates that the created target is the current local host.</maml:para>
        </maml:description>
        <command:parameterValue required="true" variableLength="true">SwitchParameter</command:parameterValue>
      </command:parameter>
      <command:parameter required="true" variableLength="false" globbing="false" pipelineInput="false" position="Named" aliases="none">
        <maml:name>NoAccess</maml:name>
        <maml:description>
          <maml:para>Indicates that no access is available to the target.
Therefore, connections will never be opened to this target.</maml:para>
        </maml:description>
        <command:parameterValue required="true" variableLength="true">SwitchParameter</command:parameterValue>
      </command:parameter>
      <command:parameter required="false" variableLength="false" globbing="false" pipelineInput="false" position="Named" aliases="none">
        <maml:name>PSSessionConfigurationName</maml:name>
        <maml:description>
          <maml:para>Specifies the remote Windows PowerShell session configuration to utilize when a remote runspace is opened.
If you omit this parameter, the default runspace is utilized by the **Get-HgsTrace** cmdlet, or the HGS configuration for targets that have the HostGuardianService role.</maml:para>
        </maml:description>
        <command:parameterValue required="false" variableLength="true">String</command:parameterValue>
      </command:parameter>
      <command:parameter required="false" variableLength="false" globbing="false" pipelineInput="false" position="Named" aliases="none">
        <maml:name>Role</maml:name>
        <maml:description>
          <maml:para>Specifies the role a particular target plays in a guarded fabric.
This can be a HGS node (HostGuardianService) or a Guarded Host (GuardedHost).
If you do not specify a role, it will be inferred by the open connection and the inspection of the installed Windows features.</maml:para>
        </maml:description>
        <command:parameterValue required="false" variableLength="true">BaseHgsRoles[]</command:parameterValue>
      </command:parameter>
    </command:parameters>
    <command:inputTypes />
    <command:returnValues>
      <command:returnValue>
        <dev:type>
          <dev:name>Microsoft.Windows.HostGuardianService.Diagnostics.Payload.InputTarget</dev:name>
        </dev:type>
        <maml:description>
          <maml:para>This cmdlet returns a target object that is a collection of metadata that contains connection information of a host operating in a guarded fabric as well as its role in the fabric.</maml:para>
        </maml:description>
      </command:returnValue>
    </command:returnValues>
    <maml:alertSet>
      <maml:alert>
        <maml:para />
      </maml:alert>
    </maml:alertSet>
    <command:examples>
      <command:example>
        <maml:title>--------- Example 1: Create a default target object ---------</maml:title>
        <maml:introduction>
          <maml:para>```
PS C:\&gt; New-HgsTraceTarget -Local
```</maml:para>
          <maml:para>&#x80;</maml:para>
          <maml:para>This command creates a target object named localhost.
Since this command does not specify a role, the cmdlet will use the credentials of the current session and then infers the role though the list of installed features on the target.</maml:para>
        </maml:introduction>
        <dev:code />
        <dev:remarks />
      </command:example>
      <command:example>
        <maml:title>--------- Example 2: Create a target with different credentials and a specified role ---------</maml:title>
        <maml:introduction>
          <maml:para>```
PS C:\&gt; New-HgsTraceTarget -HostName "hgs-01.contoso.com" -Credential (Get-Credential) -Role HostGuardianService
```</maml:para>
          <maml:para>&#x80;</maml:para>
          <maml:para>This command creates a target object with hostname named hgs-01.contoso.com that uses the provided credentials and makes the target a HGS node.</maml:para>
        </maml:introduction>
        <dev:code />
        <dev:remarks />
      </command:example>
      <command:example>
        <maml:title>--------- Example 3: Create a target to which no access is available with a specified role ---------</maml:title>
        <maml:introduction>
          <maml:para>```
PS C:\&gt; New-HgsTraceTarget -HostName "hyperv-02.contoso.com" -NoAccess -Role GuardedHost
```</maml:para>
          <maml:para>&#x80;</maml:para>
          <maml:para>This command creates a target object with hostname named hyperv-02.contoso.com that has no credentials but is regarded as a guarded host.
No attempt will be made to connect to a NoAccess target.</maml:para>
        </maml:introduction>
        <dev:code />
        <dev:remarks />
      </command:example>
      <command:example>
        <maml:title>--------- Example 4: Create a target that reuses the current session's credentials and a specified role ---------</maml:title>
        <maml:introduction>
          <maml:para>```
PS C:\&gt; New-HgsTraceTarget -HostName "hgs-01.contoso.com" -role HostGuardianService
```</maml:para>
          <maml:para>&#x80;</maml:para>
          <maml:para>This command creates a target object with hostname named hgs-01.contoso.com that reuses the credentials of the current session and makes the target a HGS node.</maml:para>
        </maml:introduction>
        <dev:code />
        <dev:remarks />
      </command:example>
      <command:example>
        <maml:title>--------- Example 5: Create a target that reuses the current session's credentials and infer the role ---------</maml:title>
        <maml:introduction>
          <maml:para>```
PS C:\&gt; New-HgsTraceTarget -HostName "hyperv-02.contoso.com"
```</maml:para>
          <maml:para>&#x80;</maml:para>
          <maml:para>This command creates a target object with hostname hyperv-02.contoso.com that reuses the credentials of the current session and then infers the role though the list of installed features on the target.</maml:para>
        </maml:introduction>
        <dev:code />
        <dev:remarks />
      </command:example>
    </command:examples>
    <command:relatedLinks>
      <maml:navigationLink>
        <maml:linkText>Online Version</maml:linkText>
        <command:uri>https://learn.microsoft.com/powershell/module/hgsdiagnostics/new-hgstracetarget?view=windowsserver2025-ps&amp;wt.mc_id=ps-gethelp</command:uri>
      </maml:navigationLink>
      <maml:navigationLink>
        <maml:linkText>Test-HgsTraceTarget</maml:linkText>
        <command:uri>./Test-HgsTraceTarget.md</command:uri>
      </maml:navigationLink>
      <maml:navigationLink>
        <maml:linkText>Get-HgsTrace</maml:linkText>
        <command:uri>./Get-HgsTrace.md</command:uri>
      </maml:navigationLink>
    </command:relatedLinks>
  </command:command>
  <command:command>
    <command:details>
      <command:name>Test-HgsTraceTarget</command:name>
      <maml:description>
        <maml:para>Verifies that a remote Windows PowerShell® session can be opened to the provided target.</maml:para>
      </maml:description>
      <command:verb>Test</command:verb>
      <command:noun>HgsTraceTarget</command:noun>
    </command:details>
    <maml:description>
      <maml:para>The **Test-HgsTraceTarget** cmdlet verifies that a remote Windows PowerShell® session can be opened to the specified target and that a compatible version of the diagnostic module is available.</maml:para>
    </maml:description>
    <command:syntax>
      <command:syntaxItem>
        <maml:name>Test-HgsTraceTarget</maml:name>
        <command:parameter required="true" variableLength="false" globbing="false" pipelineInput="false" position="Named" aliases="none">
          <maml:name>Target</maml:name>
          <maml:description>
            <maml:para>Specifies the target object to be tested.</maml:para>
          </maml:description>
          <command:parameterValue required="true" variableLength="true">InputTarget</command:parameterValue>
        </command:parameter>
      </command:syntaxItem>
    </command:syntax>
    <command:parameters>
      <command:parameter required="true" variableLength="false" globbing="false" pipelineInput="false" position="Named" aliases="none">
        <maml:name>Target</maml:name>
        <maml:description>
          <maml:para>Specifies the target object to be tested.</maml:para>
        </maml:description>
        <command:parameterValue required="true" variableLength="true">InputTarget</command:parameterValue>
      </command:parameter>
    </command:parameters>
    <command:inputTypes>
      <command:inputType>
        <dev:type>
          <dev:name>Microsoft.Windows.HostGuardianService.Diagnostics.Payload.InputTarget</dev:name>
        </dev:type>
        <maml:description>
          <maml:para>You can pipe a target object created by the **New-HgsTraceTarget** cmdlet.</maml:para>
        </maml:description>
      </command:inputType>
    </command:inputTypes>
    <command:returnValues>
      <command:returnValue>
        <dev:type>
          <dev:name>System.Boolean</dev:name>
        </dev:type>
        <maml:description>
          <maml:para>This cmdlet returns true if a connection can be opened and the requisite conditions are met by that target; false otherwise.
The cmdlet reports a detailed error if the test fails.</maml:para>
        </maml:description>
      </command:returnValue>
    </command:returnValues>
    <maml:alertSet>
      <maml:alert>
        <maml:para />
      </maml:alert>
    </maml:alertSet>
    <command:examples />
    <command:relatedLinks>
      <maml:navigationLink>
        <maml:linkText>Online Version</maml:linkText>
        <command:uri>https://learn.microsoft.com/powershell/module/hgsdiagnostics/test-hgstracetarget?view=windowsserver2025-ps&amp;wt.mc_id=ps-gethelp</command:uri>
      </maml:navigationLink>
      <maml:navigationLink>
        <maml:linkText>New-HgsTraceTarget</maml:linkText>
        <command:uri>./New-HgsTraceTarget.md</command:uri>
      </maml:navigationLink>
    </command:relatedLinks>
  </command:command>
</helpItems>